<html>
<head>
<script language="javascript">
function Dec2Hex(val) 
{
	var hexChars = "0123456789ABCDEF";
	var a = val % 16;
	var b = (val - a) / 16;
	return "" + hexChars.charAt(b) + hexChars.charAt(a);
}

function xorstr(form) 
{
	var rawtext = "";
	for (var i = 0; i < form.inp.value.length; ++i)
	{
		var c = form.inp.value.charAt(i);
		if (c == '\\')
		{
			++i;
			c = form.inp.value.charAt(i);
			if (c == '\\')
				c = '\\';
			else if (c == 'n')
				c = "\n";
			else if (c == 'r')
				c = "\r";
			else if (c == 't')
				c = "\t";
			else if (c == 'f')
				c = "\f";
			else if (c == 'b')
				c = "\b";
			else if (c == '"')
				c = "\"";
			else
			{
				alert("invalid control sequence: \\" + c);
				return;
			}
		}
		rawtext += c;
	}
	
	var xor = Math.floor(Math.random() * 256 % 256);

	var cplusplus = "";
	var csharp = "";
	if (form.inpname.value.length > 0)
	{
		cplusplus = "XorStr " + form.inpname.value + "/*" + form.inp.value + "*/(" + (rawtext.length) + ", 0x" + Dec2Hex(xor) + ", ";
		csharp = "XorStr " + form.inpname.value + " = new /*" + form.inp.value + "*/XorStr(" + (rawtext.length) + ", 0x" + Dec2Hex(xor) + ", new uint[] { ";
	}
	else
	{
		cplusplus = "/*" + form.inp.value + "*/XorStr(" + (rawtext.length) + ", 0x" + Dec2Hex(xor) + ", ";
		csharp = "new /*" + form.inp.value + "*/XorStr(" + (rawtext.length) + ", 0x" + Dec2Hex(xor) + ", new uint[] { ";
	}
	
	var length = Math.floor(rawtext.length / 4);
	
	var encryptedArray = "";
	for (i = 0; i < length; ++i)
	{
		encryptedArray += "0x";
		for (j = 0; j < 4; ++j)
		{
			var c = rawtext.charAt(i * 4 + j, 1);
			var val = c.charCodeAt(0);
			val ^= xor;
			xor += 127;
			xor %= 256;
			encryptedArray += Dec2Hex(val);
		}
		encryptedArray += ", ";
	}
	
	if (rawtext.length % 4 != 0)
	{
		rawtext = rawtext.substr(length * 4, rawtext.length % 4);
		encryptedArray += "0x";

		for (i = 0; i < rawtext.length % 4; ++i)
		{
			var c = rawtext.charAt(i, 1);
			var val = c.charCodeAt(0);
			val ^= xor;
			xor += 127;
			xor %= 256;
			encryptedArray += Dec2Hex(val);
		}
		
		for (i = 0; i < 4 - rawtext.length % 4; ++i)
		{
			encryptedArray += "00";
		}
	}
	else
	{
		encryptedArray = encryptedArray.substr(0, encryptedArray.length - 2);
	}
	
	cplusplus += encryptedArray;
	csharp += encryptedArray;
	
	cplusplus += ")";
	csharp += " })";
	if (form.inpname.value.length > 0)
	{
		csharp += ";";
	}
	else
	{
		csharp += ".ToString()";
	}
	
	form.resultcplusplus.value = cplusplus;
	form.resultcplusplus.focus();
	form.resultcplusplus.select();
	form.resultcsharp.value = csharp;
}
</script>
</head>

<body>
<center>
	<form name="formx">
		<input onclick="this.select()" name="inp" size="185" value="" /><br /><input onclick="this.select()" name="inpname" size="30" value="" /><br/>
		<input onclick="xorstr(this.form)" type="button" value="umwandeln" /><br /> 
		<input name="resultcplusplus" size="220" /><br />
		<input name="resultcsharp" size="220" />
	</form>
</center>
<br /><br /><b>C++:</b>
<pre style="font: monospace; color: #000066; border: 1px; padding: 6px;">
<span style="color: #0000ff;">class</span> XorStr
<span style="color: #008000;">{</span>
<span style="color: #0000ff;">public</span><span style="color: #008080;">:</span>
	XorStr<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> length, <span style="color: #0000ff;">int</span> key, ...<span style="color: #008000;">)</span>
	<span style="color: #008000;">{</span>
		data.<span style="color: #007788;">reserve</span><span style="color: #008000;">(</span>length<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
&nbsp;
		<span style="color: #0000ff;">int</span> xor <span style="color: #000080;">=</span> key<span style="color: #008080;">;</span>
		<span style="color: #0000ff;">int</span> index <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">int</span> loops <span style="color: #000080;">=</span> length <span style="color: #000040;">%</span> <span style="color: #0000dd;">4</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span> <span style="color: #008080;">?</span> length <span style="color: #000040;">/</span> <span style="color: #0000dd;">4</span> <span style="color: #008080;">:</span> length <span style="color: #000040;">/</span> <span style="color: #0000dd;">4</span> <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
&nbsp;
		<span style="color: #0000ff;">va_list</span> vl<span style="color: #008080;">;</span>
		<span style="color: #0000dd;">va_start</span><span style="color: #008000;">(</span>vl, key<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> loops<span style="color: #008080;">;</span> <span style="color: #000040;">++</span>i<span style="color: #008000;">)</span>
		<span style="color: #008000;">{</span>
			<span style="color: #0000ff;">int</span> hash <span style="color: #000080;">=</span> <span style="color: #0000dd;">va_arg</span><span style="color: #008000;">(</span>vl, <span style="color: #0000ff;">int</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
&nbsp;
			<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> j <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span> j <span style="color: #000080;">&lt;</span> <span style="color: #0000dd;">4</span><span style="color: #008080;">;</span> j<span style="color: #000040;">++</span><span style="color: #008000;">)</span>
			<span style="color: #008000;">{</span>
				WORD word <span style="color: #000080;">=</span> HIWORD<span style="color: #008000;">(</span>hash<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
&nbsp;
				<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>j <span style="color: #000080;">&gt;=</span> <span style="color: #0000dd;">2</span><span style="color: #008000;">)</span>
				<span style="color: #008000;">{</span>
					word <span style="color: #000080;">=</span> LOWORD<span style="color: #008000;">(</span>hash<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
				<span style="color: #008000;">}</span>
&nbsp;
				<span style="color: #0000ff;">switch</span> <span style="color: #008000;">(</span>j<span style="color: #008000;">)</span>
				<span style="color: #008000;">{</span>
				<span style="color: #0000ff;">case</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">:</span>
				<span style="color: #0000ff;">case</span> <span style="color: #0000dd;">2</span><span style="color: #008080;">:</span>
					data <span style="color: #000040;">+</span><span style="color: #000080;">=</span> HIBYTE<span style="color: #008000;">(</span>word<span style="color: #008000;">)</span> <span style="color: #000040;">^</span> xor<span style="color: #008080;">;</span>
					<span style="color: #0000ff;">break</span><span style="color: #008080;">;</span>
				<span style="color: #0000ff;">case</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">:</span>
				<span style="color: #0000ff;">case</span> <span style="color: #0000dd;">3</span><span style="color: #008080;">:</span>
					data <span style="color: #000040;">+</span><span style="color: #000080;">=</span> LOBYTE<span style="color: #008000;">(</span>word<span style="color: #008000;">)</span> <span style="color: #000040;">^</span> xor<span style="color: #008080;">;</span>
					<span style="color: #0000ff;">break</span><span style="color: #008080;">;</span>
				<span style="color: #008000;">}</span>
				xor <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">127</span><span style="color: #008080;">;</span>
				xor <span style="color: #000040;">%</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">256</span><span style="color: #008080;">;</span>
&nbsp;
				<span style="color: #000040;">++</span>index<span style="color: #008080;">;</span>
&nbsp;
				<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>index <span style="color: #000080;">&gt;=</span> length<span style="color: #008000;">)</span>
				<span style="color: #008000;">{</span>
					<span style="color: #0000ff;">break</span><span style="color: #008080;">;</span>
				<span style="color: #008000;">}</span>
			<span style="color: #008000;">}</span>  
		<span style="color: #008000;">}</span> 
		<span style="color: #0000dd;">va_end</span><span style="color: #008000;">(</span>vl<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
&nbsp;
	operator <span style="color: #0000ff;">const</span> std<span style="color: #008080;">::</span><span style="color: #007788;">string</span><span style="color: #000040;">&amp;</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span> <span style="color: #0000ff;">const</span>
	<span style="color: #008000;">{</span>
		<span style="color: #0000ff;">return</span> data<span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
&nbsp;
	<span style="color: #0000ff;">const</span> <span style="color: #0000ff;">char</span><span style="color: #000040;">*</span> c_str<span style="color: #008000;">(</span><span style="color: #008000;">)</span> <span style="color: #0000ff;">const</span>
	<span style="color: #008000;">{</span>
		<span style="color: #0000ff;">return</span> data.<span style="color: #007788;">c_str</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
&nbsp;
<span style="color: #0000ff;">private</span><span style="color: #008080;">:</span>
	std<span style="color: #008080;">::</span><span style="color: #007788;">string</span> data<span style="color: #008080;">;</span>
<span style="color: #008000;">}</span><span style="color: #008080;">;</span>
&nbsp;
std<span style="color: #008080;">::</span><span style="color: #007788;">string</span> var <span style="color: #000080;">=</span> <span style="color: #ff0000; font-style: italic;">/*OldSchoolHack*/</span>XorStr<span style="color: #008000;">(</span><span style="color: #0000dd;">13</span>, <span style="color: #208080;">0x27</span>, <span style="color: #208080;">0x68CB43F4</span>, <span style="color: #208080;">0x44CF48C8</span>, <span style="color: #208080;">0x4BEF46C4</span>, <span style="color: #208080;">0x4C000000</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">const</span> <span style="color: #0000ff;">char</span> <span style="color: #000040;">*</span>var2 <span style="color: #000080;">=</span> <span style="color: #ff0000; font-style: italic;">/*XorStr by KN4CK3R*/</span>XorStr<span style="color: #008000;">(</span><span style="color: #0000dd;">17</span>, <span style="color: #208080;">0x43</span>, <span style="color: #208080;">0x1BAC3190</span>, <span style="color: #208080;">0x37B163A1</span>, <span style="color: #208080;">0x3AE3088D</span>, <span style="color: #208080;">0x778008F0</span>, <span style="color: #208080;">0x11000000</span><span style="color: #008000;">)</span>.<span style="color: #007788;">c_str</span><span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span> <span style="color: #666666;">//WARNING: take care of the stack!</span>
</pre>
<br /><b>C#:</b>
<pre style="font: monospace; color: #000066; border: 1px; padding: 6px;"><span style="color: #6666cc; font-weight: bold;">class</span> XorStr
<span style="color: #008000;">&#123;</span>
	<span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #6666cc; font-weight: bold;">string</span> data<span style="color: #008000;">;</span>
&nbsp;
	<span style="color: #0600FF; font-weight: bold;">public</span> XorStr<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> length, <span style="color: #6666cc; font-weight: bold;">byte</span> key, <span style="color: #6666cc; font-weight: bold;">uint</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> encryptedString<span style="color: #008000;">&#41;</span>
	<span style="color: #008000;">&#123;</span>
		StringBuilder sb <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> StringBuilder<span style="color: #008000;">&#40;</span>encryptedString<span style="color: #008000;">.</span><span style="color: #0000FF;">Length</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
		<span style="color: #6666cc; font-weight: bold;">int</span> truncLength <span style="color: #008000;">=</span> length <span style="color: #008000;">/</span> <span style="color: #FF0000;">4</span><span style="color: #008000;">;</span>
		<span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> i <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> i <span style="color: #008000;">&lt;</span> truncLength<span style="color: #008000;">;</span> <span style="color: #008000;">++</span>i<span style="color: #008000;">&#41;</span>
		<span style="color: #008000;">&#123;</span>
			var bytes <span style="color: #008000;">=</span> BitConverter<span style="color: #008000;">.</span><span style="color: #0000FF;">GetBytes</span><span style="color: #008000;">&#40;</span>encryptedString<span style="color: #008000;">&#91;</span>i<span style="color: #008000;">&#93;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			Array<span style="color: #008000;">.</span><span style="color: #0000FF;">Reverse</span><span style="color: #008000;">&#40;</span>bytes<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			<span style="color: #0600FF; font-weight: bold;">foreach</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">byte</span> b <span style="color: #0600FF; font-weight: bold;">in</span> bytes<span style="color: #008000;">&#41;</span>
			<span style="color: #008000;">&#123;</span>
				sb<span style="color: #008000;">.</span><span style="color: #0000FF;">Append</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">char</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#40;</span>b <span style="color: #008000;">^</span> key<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
				key <span style="color: #008000;">+=</span> <span style="color: #FF0000;">127</span><span style="color: #008000;">;</span>
			<span style="color: #008000;">&#125;</span>
		<span style="color: #008000;">&#125;</span>
&nbsp;
		<span style="color: #6666cc; font-weight: bold;">int</span> remainLength <span style="color: #008000;">=</span> truncLength <span style="color: #008000;">*</span> <span style="color: #FF0000;">4</span><span style="color: #008000;">;</span>
		<span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>remainLength <span style="color: #008000;">&lt;</span> length<span style="color: #008000;">&#41;</span>
		<span style="color: #008000;">&#123;</span>
			var bytes <span style="color: #008000;">=</span> BitConverter<span style="color: #008000;">.</span><span style="color: #0000FF;">GetBytes</span><span style="color: #008000;">&#40;</span>encryptedString<span style="color: #008000;">&#91;</span>encryptedString<span style="color: #008000;">.</span><span style="color: #0000FF;">Length</span> <span style="color: #008000;">-</span> <span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			Array<span style="color: #008000;">.</span><span style="color: #0000FF;">Reverse</span><span style="color: #008000;">&#40;</span>bytes<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			<span style="color: #0600FF; font-weight: bold;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span> i <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span> i <span style="color: #008000;">&lt;</span> length <span style="color: #008000;">-</span> remainLength<span style="color: #008000;">;</span> <span style="color: #008000;">++</span>i<span style="color: #008000;">&#41;</span>
			<span style="color: #008000;">&#123;</span>
				sb<span style="color: #008000;">.</span><span style="color: #0000FF;">Append</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">char</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#40;</span>bytes<span style="color: #008000;">&#91;</span>i<span style="color: #008000;">&#93;</span> <span style="color: #008000;">^</span> key<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
				key <span style="color: #008000;">+=</span> <span style="color: #FF0000;">127</span><span style="color: #008000;">;</span>
			<span style="color: #008000;">&#125;</span>
		<span style="color: #008000;">&#125;</span>
&nbsp;
		data <span style="color: #008000;">=</span> sb<span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	<span style="color: #008000;">&#125;</span>
&nbsp;
	<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">override</span> <span style="color: #6666cc; font-weight: bold;">string</span> ToString<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
	<span style="color: #008000;">&#123;</span>
		<span style="color: #0600FF; font-weight: bold;">return</span> data<span style="color: #008000;">;</span>
	<span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span>
&nbsp;
<span style="color: #008000;">new</span> <span style="color: #008080; font-style: italic;">/*OldSchoolHack*/</span>XorStr<span style="color: #008000;">&#40;</span><span style="color: #FF0000;">13</span>, 0x7F, <span style="color: #008000;">new</span> <span style="color: #6666cc; font-weight: bold;">uint</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">&#123;</span> 0x309219AF, 0x18921697, 0x1BBE1497, 0x18000000 <span style="color: #008000;">&#125;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
XorStr osh <span style="color: #008000;">=</span> <span style="color: #008000;">new</span> <span style="color: #008080; font-style: italic;">/*OldSchoolHack*/</span>XorStr<span style="color: #008000;">&#40;</span><span style="color: #FF0000;">13</span>, 0xF5, <span style="color: #008000;">new</span> <span style="color: #6666cc; font-weight: bold;">uint</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">&#123;</span> 0xBA189721, 0x92188001, 0x81248A09, 0x82000000 <span style="color: #008000;">&#125;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
</body>
</html>